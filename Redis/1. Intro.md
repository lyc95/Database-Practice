# Redis
NoSQL - Not Only SQL
1. key-value  storage system.
2. Data Types: 
    * string
    * list
    * set
    * zset(sorted set)
    * hash
3. Data are cached in memory.
4. Periodly sync with disk.
5. master-slave sync.

## Install
```bash
#  download 
wget https://download.redis.io/redis-stable.tar.gz
# unpackage
tar -xzvf redis-stable.tar.gz
cd redis-stable
# compliation
make
# install
make install
# check the installed files
cd /usr/local/bin
```
Files
```bash
# performance testing tools
redis-benchmark
redis-cli
# service start up
redis-server
```
## Redis Run as Daemon
```bash
# Copy redis.conf to path that your want. for example /etc
cp redis.conf /etc/redis.conf
# Edit the configuration file
nano /etc/redis.conf
# change daemonize to yes
daemonize yes
# run as daemon
cd /usr/local/bin/
./redis-server /etc/redis.conf
# check process
ps -ef | grep redis 

# access in by CLI
./redis-cli
```

## Note for Database
1. There are 16 databases by default. we can switch db by.
```bash
# select database with target index
select <index>
```
2. Redis is Single Thread & IO multiplexing.(多路IO复用)
3. 6379 port.

## Redis key operations
```bash
# list current keys in the database
keys *
# check whether key existed, 1 exist , 0 not exist
exists <key>
# delete target key
del <key>
unlink <key> # async delete
# set expiration date
expire <key> <number>
# check remianing time before expiration
# -1 never, -2 expired
ttkl <key>
# check nos of keys in the db
dbsize
# clear db
flushdb
# clear all dbs
flushall
```
## Redis Data
### string
* Max. 512MB for the string value
```bash
# set key-value pairs
set <key> <val>
get <key>
# append val to the existing val associated to the key
append <key> <val>
# get length of value
strlen <key>
# put if absent
setnx <key> <value>

# add 1 to the number value or set to 1 if null
incr <key>
# deduct 1 to the number value or set to -1 if null
decr <key>
# incrby/decrby
incrby/decrby <key> <number to be added/deducted>
# set multiple k-v paris
mset <key1> <val1> <key2> <val2> 
mget <key1> <val1> <key2> <val2> 
# set only when not existed
# if any of keys existed then all will be failed
# only all the keys are not existed, it will succeed
msetnx <key1> <val1> <key2> <val2> 

getrange <key> <startIndex> <endIndex>
# override the value from startIndex
setrange <key> <startIndex> <value>
# set value with expiration duration
setex <key> <expiration-duration> <value>
# set new val and get old value
getset <key> <val>
```
### List
Single key -> multiple values with order (deque)
```bash
# push elements from left/right
lpush/rpush key element [element ...]
# get elements
lrange key start stop # -1 means last element
# pop the elements from left/right
lpop/rpop key [count]
# pop elemnt from source at right and push to destination at left
rpoplpush source destination
# get element based on index(0 based)
lindex key index
# get length of list
llen key
# insert element into lits 
linsert key BEFORE|AFTER <pivotElement> <newElement>
# remove count elemnts from left
lrem key count element
# replce element at index
lset key index newElement
```

### Set
